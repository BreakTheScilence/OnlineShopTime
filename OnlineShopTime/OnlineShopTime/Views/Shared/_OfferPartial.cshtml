@model OnlineShopTime.Models.Offers
@using CloudinaryDotNet
@using OnlineShopTime.Utils
@using Microsoft.AspNet.Identity

@{string defaultImage = "v6ac3uaxfe5gtlqtrbr7";}

<div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 container">
    <div class="jumbotron" style=" word-wrap: break-word">

        <div class="row">
            <div class="col-lg-5 col-md-5 col-sm-3 col-xs-4">
                @Cloud.Api.UrlImgUp.Transform(new Transformation().Width(140).Height(140).Crop("fill")).BuildImageTag(Model.Photo1URL ?? defaultImage, "id = image", "class=img-responsive")
            </div>
            <div class="col-lg-7 col-md-7 col-sm-9 col-xs-8">
                <div class="container">
                    <div class="row">
                        @{float? rating = Model.OfferRaiting.Where(m => m.OfferID == Model.OfferID).Average(m => m.Raiting);}
                        <div data-rateit-value="@rating" data-rateit-ispreset="true" data-rateit-resetable="false" data-rateit-step="1" data-offerid="@Model.OfferID" data-userid="@User.Identity.GetUserId()" class=" rateit"></div>
                    </div>
                    <div class="row">
                        <h3 style="margin-top:0px">
                            @Html.ActionLink(@Model.Name, "OfferPage", "Offer", new { OfferID = @Model.OfferID }, null)
                        </h3>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <h5 style="text-overflow:ellipsis">@Model.Description</h5>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <h3>
                    @{
                        String DisplayName = Model.Users.FirstName + " " + Model.Users.LastName;
                        @Html.ActionLink((string)DisplayName, "ShowUserOffers", "Offer", new { UserID = @Model.OfferedBy }, new { @style = "margin-top:0px" })
                    }
                </h3>
            </div>
        </div>

        @if (ViewBag.Buttons != null) //Only for Orders Page. Forget about everything that going sown here.
        {
            <br>
            if (ViewBag.Buttons == "IncomingOrdersAwait")
            {
                <div class="row">
                    <div class="col-lg-4 col-md-4">
                        <a href="ApplyOrder?OrderID=@ViewBag.OrderID" class="btn btn-default btn-lg" style="width: 100%; margin-top: 2%;">@Resources.Home.OrderApply</a>
                    </div>
                    <div class="col-lg-4 col-md-4">
                        <a href="DenyOrder?OrderID=@ViewBag.OrderID" class="btn btn-default btn-lg" style="width: 100%; margin-top: 2%;">@Resources.Home.OrderDeny</a>
                    </div>
                    <div class="col-lg-4 col-md-4">
                        <a href="ShowUserInfo?ClientID=@ViewBag.ClientID" class="btn btn-default btn-lg" style="width: 100%; margin-top: 2%;">@Resources.Home.Client</a>
                    </div>
                </div>
            }
            if (ViewBag.Buttons == "IncomingOrdersActive")
            {
                <div class="row">
                    <div class="col-lg-4 col-md-4"></div>
                    <div class="col-lg-4 col-md-4">
                        <a href="DenyOrder?OrderID=@ViewBag.OrderID" class="btn btn-default btn-lg" style="width: 100%; margin-top: 2%;">@Resources.Home.OrderDeny</a>
                    </div>
                    <div class="col-lg-4 col-md-4">
                        <a href="ShowUserInfo?ClientID=@ViewBag.ClientID" class="btn btn-default btn-lg" style="width: 100%; margin-top: 2%;">@Resources.Home.Client</a>
                    </div>
                </div>
            }
        }
    </div>
</div>
